// Custom resource configuration for nf-core/smrnaseq
process {
    // Global resource limits – any process exceeding these will fail
    resourceLimits = [
        cpus: 32,
        memory: 240.GB,
        time: 48.h
    ]

    // Default labels used by the pipeline
    withLabel:process_low {
        cpus   = 4
        memory = 12.GB
        time   = 3.h
    }

    withLabel:process_medium {
        cpus   = 8
        memory = 24.GB
        time   = 6.h
    }

    withLabel:process_high {
        cpus   = 12
        memory = 48.GB
        time   = 12.h
    }

    // Specific process overrides
    withName: 'NFCORE_SMRNASEQ:UMITOOLS_EXTRACT' {
        cpus   = 6
        memory = 24.GB
        time   = 1.h
    }

    withName: 'NFCORE_SMRNASEQ:MIRNA_QUANT:BOWTIE_MAP_MATURE' {
        cpus   = 8
        memory = 48.GB
        time   = 3.h
    }

    withName: 'NFCORE_SMRNASEQ:MIRNA_QUANT:BOWTIE_MAP_SEQCLUSTER' {
        cpus   = 8
        memory = 48.GB
        time   = 3.h
    }

    withName: 'NFCORE_SMRNASEQ:MIRNA_QUANT:BOWTIE_MAP_HAIRPIN' {
        cpus   = 8
        memory = 48.GB
        time   = 3.h
    }

    // UMI collapse is memory‑intensive; we increase memory, allow longer runtime,
    // and enable automatic retries in case of failure.
    withName: 'NFCORE_SMRNASEQ:UMICOLLAPSE_FASTQ' {
        cpus          = 4
        memory        = 96.GB
        time          = 12.h       // increased from default 4h
        errorStrategy = 'retry'     // retry on failure
        maxRetries    = 2           // up to two retries
    }
}

// AWS settings: anonymous access (no credentials required for public data)
aws {
    client {
        anonymous = true
    }
}